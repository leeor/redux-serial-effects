# Redux Serial Effects

A middleware library for managing side-effects based on state changes, following an actual vs.
expected philosophy, and supporting composability.

## Background

Given a complex UI application that manages external resources (e.g., REST services), we can
describe external services' state as the actual state, and the application state (as modified by
user interactions) as the expected state - this is what the user wants the system as a whole to
look/behave like.

It is the role of side-effects generated by the application to make sure the actual state is changed
and realigned with the expected state.

The concept behind this middleware is to generate side-effects based on the difference between the
actual and expected states, as opposed to solely based on dispatched actions. In the long term, this
should allow graceful recovery in case of network errors or any other sort of service disruption.

## Implementation

The middleware has a `subscribe()` method for registering `subscriber` handlers. These `subscriber`s
can be composed, similarly to `reducer`s, and will be called whenever the section of the state they
are mapped to is changed by a dispatched action.

### Creating a Middleware Instance

Import:
```javascript
const { serialEffectsMiddleware } = require('redux-serial-effects')
```

Instantiate:
```javascript
const { middleware, subscribe } = serialEffectsMiddleware
```

Or, with an extra argument:
```javascript
const { middleware, subscribe } = serialEffectsMiddleware.withExtraArgument(api)
```

### Subscribing & Generating Side-effects

The signature of a `subscriber` is:
```javascript
subscriber({ from, to }, dispatch, extraArgument)
```

The expected return value is a promise that will resolve when the side-effects generated by the call
have fully resolved.

The `subscriber` has the option to compare either the state read from external services or the
`from` state to the `to` state to generate the list of side-effect that will change the actual state
to match the expected state.
